# Структура исполнительских задач

## Концепция

Исполнительские задачи - это конкретные, атомарные действия, которые можно выполнить за один рабочий сеанс.

## Уровни абстракции

```
Plans (стратегия)
   ↓ декомпозиция
Tasks (тактика)
   ↓ выполнение
Results (результат)
```

### Различия между планами и задачами

| Аспект | Plan | Task |
|--------|------|------|
| Уровень | Стратегический | Тактический |
| Срок | Дни/недели | Часы/день |
| Объем | Множество действий | Одно действие |
| Декомпозиция | Разбивается на задачи | Атомарная единица |
| Примеры | "Создать раздел про ООП" | "Написать урок про классы" |

## Структура директорий

```
tasks/
├── board/                      # Kanban-доска задач
│   ├── todo.md                 # Новые задачи
│   ├── in-progress.md          # В работе (макс 1-3)
│   ├── review.md               # На ревью
│   ├── blocked.md              # Заблокированные
│   └── done.md                 # Завершенные (последние)
│
├── content/                    # Контентные задачи
│   ├── lesson-[name].md
│   ├── exercise-[name].md
│   └── review-[name].md
│
├── technical/                  # Технические задачи
│   ├── infra-[name].md
│   ├── automation-[name].md
│   └── tooling-[name].md
│
├── planning/                   # Задачи планирования
│   ├── research-[name].md
│   └── design-[name].md
│
├── archive/                    # Архив выполненных задач
│   └── 2025/
│       └── 12/
│           └── [date]-[task].md
│
└── STRUCTURE.md                # Этот файл
```

## Формат задачи

```markdown
# Задача: [Краткое название]

## Метаданные
- **ID**: TASK-[YYYY-MM-DD]-[NNN]
- **Создана**: [дата и время]
- **Статус**: [todo/in-progress/review/blocked/done]
- **Приоритет**: [low/medium/high/critical]
- **Исполнитель**: [кто выполняет]
- **Оценка времени**: [часы]
- **Фактическое время**: [часы]

## Связи
- **План**: [ссылка на plans/...] (опционально)
- **Зависит от**: [другие задачи]
- **Блокирует**: [другие задачи]

## Описание
[Четкое описание - что нужно сделать]

## Контекст
[Почему это нужно, какую проблему решает]

## Критерии выполнения
- [ ] Критерий 1
- [ ] Критерий 2
- [ ] Критерий 3

## Используемые ресурсы
- Промпты: [ссылки на prompts/]
- Документация: [ссылки]
- Примеры: [ссылки]

## Шаги выполнения
1. [ ] Шаг 1
2. [ ] Шаг 2
3. [ ] Шаг 3

## Заметки
[Замечания в процессе работы]

## Результат
[Что получилось, ссылки на созданные файлы]

## История
- 2025-12-22 10:30: Создана
- 2025-12-22 14:00: Начата работа
- 2025-12-22 16:30: Завершена
```

## Kanban-доска

### Принципы работы

1. **WIP Limit** - максимум 1-3 задачи одновременно в in-progress
2. **Pull System** - берешь новую задачу только когда закончил предыдущую
3. **Приоритизация** - задачи в todo упорядочены по приоритету
4. **Видимость** - текущее состояние всегда актуально

### Формат board файлов

`tasks/board/todo.md`:
```markdown
# Задачи: TODO

Обновлено: 2025-12-22 10:00

## Критические

### TASK-2025-12-22-001: Написать урок про Pattern Matching
- Приоритет: critical
- Оценка: 4h
- План: plans/content/lessons/in-progress/pattern-matching.md
- Зависит от: -

## Высокий приоритет

### TASK-2025-12-22-002: Создать упражнения для урока про Option
- Приоритет: high
- Оценка: 2h
- План: plans/content/lessons/completed/option.md
- Зависит от: TASK-2025-12-22-001

## Средний приоритет

[...]

## Низкий приоритет

[...]
```

`tasks/board/in-progress.md`:
```markdown
# Задачи: В РАБОТЕ

⚠️ WIP Limit: 3 задачи максимум

Обновлено: 2025-12-22 14:00

## TASK-2025-12-22-003: Рефакторинг урока про функции
- Начата: 2025-12-22 13:00
- Исполнитель: Claude + User
- Прогресс: 60%
- Статус: Создана теория, работаю над примерами
- Файл: tasks/content/lesson-functions-refactor.md

[...]
```

## Жизненный цикл задачи

```
   create
     ↓
  ┌──TODO──┐
  │        │
  │  pull  │
  ↓        ↓
IN-PROGRESS
  │        │
  │ block  │ complete
  ↓        ↓
BLOCKED  REVIEW
  │        │
  │ resolve│ approve
  │        ↓
  └──→  DONE ──→ ARCHIVE
```

### Переходы между статусами

1. **TODO → IN-PROGRESS**: Взял задачу в работу
2. **IN-PROGRESS → REVIEW**: Задача выполнена, нужно ревью
3. **IN-PROGRESS → BLOCKED**: Наткнулся на блокер
4. **BLOCKED → TODO**: Блокер снят, можно брать снова
5. **REVIEW → DONE**: Ревью пройдено
6. **REVIEW → IN-PROGRESS**: Нужны исправления
7. **DONE → ARCHIVE**: Задача архивирована (периодически)

## Команды для работы с задачами

### Создание задачи

```
@create-task:
  название: "Написать урок про Pattern Matching"
  тип: content/lesson
  приоритет: high
  оценка: 4h
  план: plans/content/lessons/in-progress/pattern-matching.md
```

### Начать работу над задачей

```
@start-task: TASK-2025-12-22-001
```

Claude:
1. Проверяет WIP limit
2. Перемещает из todo.md в in-progress.md
3. Открывает файл задачи
4. Обновляет метаданные
5. Готов к работе

### Завершить задачу

```
@complete-task: TASK-2025-12-22-001
```

Claude:
1. Проверяет критерии выполнения
2. Заполняет раздел "Результат"
3. Перемещает в review.md или done.md
4. Обновляет связанные планы

### Заблокировать задачу

```
@block-task: TASK-2025-12-22-001
  причина: "Ожидаю создания примеров кода"
```

### Обновить статус

```
@update-task: TASK-2025-12-22-001
  прогресс: 75%
  заметка: "Завершена теория, осталось 2 примера"
```

### Архивировать завершенные задачи

```
@archive-done-tasks
```

Claude:
1. Перемещает задачи из done.md в archive/
2. Обновляет board/done.md (оставляет последние 10)
3. Создает резюме по архивированным задачам

## Связь с планами

### План → Задачи

План содержит ссылки на задачи:

```markdown
# План: Создание серии уроков про коллекции

## Задачи

### Созданные
- [TASK-2025-12-22-001](../../../tasks/content/lesson-list.md) - Урок про List (done)
- [TASK-2025-12-22-002](../../../tasks/content/lesson-set.md) - Урок про Set (in-progress)

### Требуют создания
- [ ] Урок про Map
- [ ] Урок про Vector
```

### Задача → План

Задача ссылается на план:

```markdown
# Задача: Написать урок про List

## Связи
- План: [Серия уроков про коллекции](../../../plans/content/lessons/collections.md)
```

## Типы задач

### Content (контентные)

- **lesson-[topic]** - Создание урока
- **exercise-[topic]** - Создание упражнения
- **review-[topic]** - Ревью материала
- **refactor-[topic]** - Рефакторинг существующего

### Technical (технические)

- **infra-[name]** - Инфраструктурные задачи
- **automation-[name]** - Автоматизация
- **tooling-[name]** - Инструментарий
- **integration-[name]** - Интеграция

### Planning (планирование)

- **research-[topic]** - Исследование
- **design-[topic]** - Проектирование
- **estimation-[topic]** - Оценка

## Метрики и аналитика

### Velocity

Отслеживание скорости:
```markdown
# Velocity Report

## Неделя 2025-12-16 - 2025-12-22
- Completed: 12 tasks
- Total estimated: 40h
- Total actual: 45h
- Velocity: 0.89 (estimated/actual)

## По типам
- content: 8 tasks (30h)
- technical: 3 tasks (12h)
- planning: 1 task (3h)
```

### Burndown

Отслеживание прогресса:
```
Оставшиеся задачи по дням:
День 1: 20 tasks
День 2: 18 tasks
День 3: 15 tasks
...
```

## Автоматизация

### Скрипты

```bash
# Показать kanban-доску
./scripts/show-kanban.sh

# Создать задачу
./scripts/create-task.sh "Название" content high 4h

# Переместить задачу
./scripts/move-task.sh TASK-001 todo in-progress

# Архивировать done
./scripts/archive-done.sh

# Статистика
./scripts/task-stats.sh
```

### Git hooks

```bash
# Pre-commit hook - проверка WIP limit
if [ $(count_in_progress_tasks) -gt 3 ]; then
  echo "WIP limit exceeded!"
  exit 1
fi
```

## Интеграция с quick-commands.md

Добавить в команды:

```markdown
## Команды для работы с задачами

@create-task: создание новой задачи
@start-task: начать работу
@complete-task: завершить задачу
@block-task: заблокировать задачу
@update-task: обновить статус
@show-kanban: показать доску
@archive-done-tasks: архивировать выполненные
```

## Лучшие практики

### ✅ DO

- Создавай задачи для всех нетривиальных действий
- Держи WIP limit (1-3 задачи максимум)
- Обновляй статус регулярно
- Заполняй раздел "Результат" при завершении
- Связывай задачи с планами
- Архивируй done задачи еженедельно

### ❌ DON'T

- Не создавай задачи для тривиальных действий (опечатки)
- Не держи задачи в in-progress без обновлений
- Не начинай новую задачу пока не закончил текущую
- Не оставляй blocked задачи без причины и ссылок

## Примеры задач

### Пример 1: Контентная задача

`tasks/content/lesson-pattern-matching.md`:
```markdown
# Задача: Написать урок про Pattern Matching

## Метаданные
- ID: TASK-2025-12-22-001
- Статус: in-progress
- Приоритет: critical
- Оценка: 4h

## Связи
- План: plans/content/lessons/in-progress/pattern-matching.md
- Промпт: prompts/composed/pattern-matching/v1.md

## Критерии выполнения
- [ ] Теоретическая часть написана
- [ ] 4 примера кода созданы
- [ ] 2 упражнения с тестами
- [ ] Материал прошел ревью

## Шаги выполнения
1. [x] Создать промпт из шаблона
2. [x] Написать теоретическую часть
3. [ ] Создать примеры кода
4. [ ] Создать упражнения
5. [ ] Ревью материала
```

### Пример 2: Техническая задача

`tasks/technical/automation-stepik-sync.md`:
```markdown
# Задача: Автоматизация синхронизации со Stepik

## Метаданные
- ID: TASK-2025-12-22-010
- Статус: todo
- Приоритет: medium
- Оценка: 6h

## Связи
- План: plans/technical/automation.md

## Описание
Создать скрипт для автоматической загрузки/выгрузки материалов на Stepik

## Критерии выполнения
- [ ] Скрипт upload.sh создан
- [ ] Скрипт download.sh создан
- [ ] Тесты написаны
- [ ] Документация обновлена
```

## Миграция с TodoWrite

Claude Code использует TodoWrite для временных todo-списков в сессии. Различия:

| TodoWrite | Tasks |
|-----------|-------|
| Временные | Постоянные |
| В памяти сессии | В файловой системе |
| Простые чек-листы | Полное описание |
| Для текущей работы | Для долгосрочного управления |

**Совместное использование:**
- TodoWrite - для оперативной работы в сессии
- Tasks - для трекинга задач в проекте
- В конце сессии - перенос из TodoWrite в Tasks если нужно

---

**Версия**: 1.0
**Дата**: 2025-12-22
