# Архитектура процесса разработки

## Обзор

Этот документ описывает архитектуру **процесса разработки курса** - модульную систему управления проектом для создания учебных материалов по Scala.

> **Примечание**: Это НЕ архитектура кодовой базы Scala проекта. Это архитектура процесса создания учебных материалов с использованием промптов, планов и задач.

## Четыре столпа системы

```
┌─────────────────────────────────────────────────────────────┐
│                    ПРОЕКТ КУРСА SCALA                        │
└─────────────────────────────────────────────────────────────┘
                              │
        ┌─────────────────────┼─────────────────────┐
        │                     │                     │
        ▼                     ▼                     ▼
   ┌─────────┐          ┌─────────┐          ┌─────────┐
   │ prompts/│          │ plans/  │          │ tasks/  │
   │ СТАТИКА │          │СТРАТЕГИЯ│          │ ТАКТИКА │
   └─────────┘          └─────────┘          └─────────┘
        │                     │                     │
        ▼                     ▼                     ▼
 Инструментарий      Что достичь          Как выполнить
 (библиотека)        (дни/недели)         (часы/день)
```

## 1. prompts/ - Статический инструментарий

**Назначение**: Библиотека переиспользуемых блоков для создания промптов

```
prompts/
├── modules/          # Атомарные блоки (контекст, стиль, структура)
├── templates/        # Композиции модулей (готовые шаблоны)
├── composed/         # Сгенерированные промпты (версионированные)
├── agents/           # Конфигурация ролей и команд
└── STRUCTURE.md      # Документация
```

**Характеристики:**
- ✓ Редко меняется
- ✓ Переиспользуется
- ✓ Версионируется как библиотека
- ✓ Композитная архитектура

**Примеры:**
- `modules/lesson/structure.md` - структура урока
- `templates/lesson-basic.md` - шаблон базового урока
- `agents/prompt-architect-activation.md` - роль архитектора

## 2. plans/ - Стратегические планы

**Назначение**: Высокоуровневые цели и направления развития курса

```
plans/
├── course/           # Roadmap, разделы, вехи
├── content/          # Планы по контенту
├── technical/        # Технические планы
├── archive/          # Завершенные планы
└── STRUCTURE.md      # Документация
```

**Характеристики:**
- ✓ Средняя динамика (обновляется еженедельно)
- ✓ Декомпозируется на задачи
- ✓ Горизонт: дни/недели
- ✓ Ссылается на tasks/

**Примеры:**
- `course/roadmap.md` - общий roadmap курса
- `content/lessons/collections.md` - план серии уроков про коллекции
- `technical/automation.md` - план автоматизации

## 3. tasks/ - Исполнительские задачи

**Назначение**: Конкретные атомарные действия для выполнения

```
tasks/
├── board/            # Kanban-доска (todo, in-progress, done, blocked)
├── by-type/          # Задачи по типам
│   ├── content/      # Контентные задачи
│   ├── technical/    # Технические задачи
│   └── planning/     # Задачи планирования
├── archive/          # Архив выполненных
└── STRUCTURE.md      # Документация
```

**Характеристики:**
- ✓ Высокая динамика (обновляется ежедневно/ежечасно)
- ✓ Атомарные действия
- ✓ Горизонт: часы/день
- ✓ Kanban с WIP limit (1-3 задачи)

**Примеры:**
- `board/in-progress.md` - текущие задачи
- `by-type/content/lesson-pattern-matching.md` - написать урок
- `by-type/technical/automation-sync.md` - создать скрипт синхронизации

## 4. content/ - Результаты работы

**Назначение**: Готовый контент курса

```
content/
├── [lesson-name]/    # Каталоги уроков
│   ├── *.step        # Оригинальные файлы Stepik (JSON)
│   └── *.md          # Конвертированные для чтения
```

**Характеристики:**
- ✓ Результат выполнения tasks
- ✓ Загружается с/на Stepik
- ✓ Версионируется в Git

## Потоки работы

### Поток 1: Создание контента

```
1. План создается
   └─> plans/content/lessons/collections.md

2. План декомпозируется на задачи
   └─> tasks/by-type/content/lesson-list.md
   └─> tasks/by-type/content/lesson-set.md

3. Задачи выполняются с использованием промптов
   └─> prompts/templates/lesson-basic.md
   └─> prompts/composed/list/v1.md

4. Результат сохраняется
   └─> content/collections/lesson-list.md
```

### Поток 2: Работа над задачей

```
1. Выбрать задачу из todo
   └─> @start-task: TASK-001

2. Переместить в in-progress
   └─> tasks/board/in-progress.md

3. Выполнить с помощью промптов
   └─> @compose-prompt шаблон=lesson-basic

4. Завершить задачу
   └─> @complete-task: TASK-001

5. Обновить план
   └─> plans/content/lessons/collections.md ✓
```

### Поток 3: Еженедельный цикл

```
Понедельник:
├─ Ревью прогресса по планам (@review-plan)
├─ Создание новых задач из планов (@create-task)
└─ Приоритизация board/todo.md

Ежедневно:
├─ Выбор 1-3 задач (@start-task)
├─ Выполнение с промптами
└─ Обновление статусов (@update-task)

Пятница:
├─ Архивация выполненных задач (@archive-done-tasks)
├─ Обновление планов с прогрессом
└─ Подготовка отчета
```

## Связи между компонентами

```
┌──────────┐
│ prompts/ │◄────── используются ──────┐
└──────────┘                            │
                                        │
┌──────────┐         ссылается         │
│  plans/  │◄───────────────┐          │
└──────────┘                │          │
     │                      │          │
     │ декомпозиция         │          │
     ▼                      │          │
┌──────────┐                │          │
│  tasks/  │────────────────┘          │
└──────────┘                            │
     │                                  │
     │ создает                          │
     ▼                                  │
┌──────────┐                            │
│ content/ │                            │
└──────────┘                            │
     │                                  │
     └───────── требует промпты ────────┘
```

## Команды быстрого доступа

Все команды определены в `prompts/agents/quick-commands.md`:

### Роли
```
@prompt-architect    - архитектор промптов
@plan-manager       - менеджер планов
```

### Промпты
```
@compose-prompt     - композиция промпта
@create-module      - создание модуля
```

### Планы
```
@create-plan        - создание плана
@update-plan        - обновление плана
@review-plan        - ревью плана
@archive-plan       - архивация плана
```

### Задачи
```
@create-task        - создание задачи
@start-task         - начать задачу
@complete-task      - завершить задачу
@update-task        - обновить задачу
@show-kanban        - показать доску
```

## Принципы архитектуры разработки

### 1. Разделение ответственности (SoC)
- Каждая папка имеет четкую ответственность
- Нет дублирования между уровнями
- Ясная иерархия абстракций

### 2. Модульность
- Промпты собираются из модулей
- Планы декомпозируются на задачи
- Компоненты независимы и переиспользуемы

### 3. Версионирование
- Всё хранится в Git
- История изменений прозрачна
- Можно откатить любые изменения

### 4. Прозрачность
- Структура файловой системы отражает процесс
- Статус видим через файлы
- Документация встроена в систему

### 5. Масштабируемость
- Легко добавлять новые модули
- Легко добавлять новые планы и задачи
- Система растет вместе с проектом

## Соглашения по именованию

### Файлы
```
plans/content/lessons/[topic].md           # План урока
tasks/by-type/content/lesson-[topic].md    # Задача создания урока
prompts/modules/lesson/[aspect].md         # Модуль для уроков
prompts/composed/[topic]/v[N].md           # Версия промпта
```

### ID задач
```
TASK-YYYY-MM-DD-NNN
TASK-2025-12-22-001
```

### Коммиты
```
plan: [действие с планом]
task: [действие с задачей]
prompt: [действие с промптом]
content: [действие с контентом]

Примеры:
plan: создан roadmap курса
task: завершена TASK-001 - урок про Pattern Matching
prompt: добавлен модуль lesson/interactive-elements
content: обновлен урок про коллекции
```

## Метрики и мониторинг

### Отслеживаемые метрики

**Планы:**
- Количество активных планов
- Прогресс выполнения (% задач)
- Блокирующие зависимости

**Задачи:**
- Velocity (задачи в неделю)
- WIP (work in progress)
- Время выполнения (оценка vs факт)
- Распределение по типам

**Промпты:**
- Количество модулей
- Частота использования
- Версии и итерации

## Лучшие практики

### ✅ DO
- Создавай задачи из планов
- Используй промпты для консистентности
- Обновляй статусы регулярно
- Версионируй изменения в Git
- Связывай планы, задачи и результаты
- Архивируй завершенное

### ❌ DON'T
- Не дублируй информацию между уровнями
- Не создавай задачи без связи с планом (если применимо)
- Не превышай WIP limit (1-3 задачи)
- Не оставляй задачи без обновлений
- Не смешивай уровни абстракции

## Документация

Каждая подсистема имеет STRUCTURE.md:
- `prompts/STRUCTURE.md` - архитектура промптов
- `plans/STRUCTURE.md` - система планов
- `tasks/STRUCTURE.md` - система задач

Главная документация:
- `CLAUDE.md` - руководство для Claude Code
- `DEVELOPMENT.md` (этот файл) - архитектура процесса разработки

---

**Версия**: 1.0
**Дата**: 2025-12-22
**Статус**: Архитектура процесса разработки определена и готова к использованию
